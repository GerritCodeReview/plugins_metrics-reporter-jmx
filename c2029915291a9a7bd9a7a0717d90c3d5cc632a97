{
  "comments": [
    {
      "key": {
        "uuid": "a665034b_1d0a1880",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/metricsreporters/GerritJmxReporter.java",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2020-02-07T15:09:09Z",
      "side": 1,
      "message": "This returns JmxReporter.Builder which provides the:\n\n  Builder.filter(MetricFilter filter)\n\nmethod. By using this feature I can eliminate the FilteredMetricRegistry and wrapping\nof the listeners it does.",
      "range": {
        "startLine": 34,
        "startChar": 32,
        "endLine": 34,
        "endChar": 53
      },
      "revId": "c2029915291a9a7bd9a7a0717d90c3d5cc632a97",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0efac524_9325caae",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/metricsreporters/GerritJmxReporter.java",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2020-02-07T15:59:14Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a665034b_1d0a1880",
      "range": {
        "startLine": 34,
        "startChar": 32,
        "endLine": 34,
        "endChar": 53
      },
      "revId": "c2029915291a9a7bd9a7a0717d90c3d5cc632a97",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5137fbf8_65a1fb63",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/metricsreporters/GerritJmxReporter.java",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1078567
      },
      "writtenOn": "2020-02-11T16:51:06Z",
      "side": 1,
      "message": "Copying the registry was added to avoid filtering the Gerrit core metrics registry. Modifying the core registry can cause the following issues:\n- Excluded metrics are not available in the registry anymore. Eg.: other plugins cannot access the filtered metrics (Note, we want to exclude the metrics _only_ in case of this single plugin)\n- Excluded metrics cannot be restored by modifying the plugin configuration and reloading the plugin. Ideally, the exclusion pattern can be modified by reloading the plugin but core metrics will not get restored only when Gerrit is restarted.\n\nPlease verify that these issues cannot happen with your implementation.",
      "parentUuid": "0efac524_9325caae",
      "range": {
        "startLine": 34,
        "startChar": 32,
        "endLine": 34,
        "endChar": 53
      },
      "revId": "c2029915291a9a7bd9a7a0717d90c3d5cc632a97",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e7f28d15_7a652ad8",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/metricsreporters/GerritJmxReporter.java",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2020-02-11T17:47:39Z",
      "side": 1,
      "message": "If I understand the code here correctly, it doesn\u0027t modify the core MetricRegistry in\nany way.\n\nWhat this code does is: create an instance of JmxReporter (plugin specific)\nwhich operates on the given FilteredMetricRegistry (plugins specific) which\nitself filters the results returned from the MetricRegistry from Gerrit core.\nThe FilteredMetricRegistry neither mutates the MetricRegistry from Gerrit core\nnor replaces it.\n\nFurther, when the plugin gets reloaded a new instance of FilteredMetricRegistry\nis created based on the (new) configuration.\n\nWhich piece of code here do you believe would modify the core MetricRegistry instance?",
      "parentUuid": "5137fbf8_65a1fb63",
      "range": {
        "startLine": 34,
        "startChar": 32,
        "endLine": 34,
        "endChar": 53
      },
      "revId": "c2029915291a9a7bd9a7a0717d90c3d5cc632a97",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80ac6ba5_c63cb625",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/metricsreporters/GerritJmxReporter.java",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2020-02-11T18:03:01Z",
      "side": 1,
      "message": "Hmm... there seem to be an issue with reloading this plugin even without\nchanging the configuration. All metrics are gone after plugin reload.\nI suspect that this is another issue probably not directly related to this change.\nLet me look into it tomorrow...",
      "parentUuid": "e7f28d15_7a652ad8",
      "range": {
        "startLine": 34,
        "startChar": 32,
        "endLine": 34,
        "endChar": 53
      },
      "revId": "c2029915291a9a7bd9a7a0717d90c3d5cc632a97",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}